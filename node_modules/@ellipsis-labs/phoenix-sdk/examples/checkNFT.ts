import { Connection, PublicKey } from "@solana/web3.js";
import madLads from "../mad-lads-assets.json";
import { AccountLayout } from "@solana/spl-token";

async function check() {
  const connection = new Connection("https://api.mainnet-beta.solana.com");
  const owner = new PublicKey("JARRY5ESTsvwDDdH3GjuM1emcx7LbfUCUAsBsSUYcCbY");
  await connection
    .getTokenAccountsByOwner(
      owner,
      {
        programId: new PublicKey("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"),
      },
      "confirmed"
    )
    .then((res) => {
      res.value.forEach((account) => {
        const data = account.account.data;
        const tokenAccount = AccountLayout.decode(data);
        const mint = tokenAccount.mint.toBase58();
        if (madLads.results.includes(mint)) {
          console.log(mint);
        }
      });
    });
}

(async function () {
  try {
    await check();
  } catch (err) {
    console.log("Error: ", err);
    process.exit(1);
  }

  process.exit(0);
})();
